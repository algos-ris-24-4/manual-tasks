# Решение задания 5: Оптимальное расписание. Стратегия разделения процессоров
### Вариант 5:

| Задания      |  A  |  B  |  C  |  D  |  E  |
|:-------------|:---:|:---:|:---:|:---:|:---:|
| Длительность | 31  | 28  |  22 | 13  |  6  |

| Исполнители           |  $P_1$  |  $P_2$  |  $P_3$  |  $P_4$  |
|:----------------------|:---:|:---:|:---:|:---:|
| Производительность(p) |  4  |  3  |  2  |  1  |
## Решение
Найдем длительность оптимального расписания заданий по формуле:

$$  
T_{min} = \frac {V_1 + V_2 + ... + V_n}{p_1 + p_2 + ... + p_k}  
$$  

$$  
T_{min} = \frac {31 + 28 + 22 + 13 + 6}{4 + 3 + 2 + 1} = 10
$$  

Выполним первый шаг алгоритма:

1. Выбрать задания с самым высоким приоритетом (может быть одно задание или несколько заданий с одинаковым приоритетом), назначить на эти задания одного или несколько самых производительных работников. Если остались свободные работники назначить их на задания со следующим приоритетом.

| Задания      |  A  |  B  |  C  |  D  |  E  |
|:-------------|:---:|:---:|:---:|:---:|:---:|
| Длительность | 31  | 28  |  22 | 13  |  6  |
| Приоритет    | 1   | 2   |  3  | 4   |  5  |
| Исполнитель  |$P_1$|$P_2$|$P_3$|$P_4$|     |

Приступим ко второму шагу:

2. Работники выполняют задания до тех пор, пока не наступит одно из событий:
- какое-либо задание будет завершено и освободится исполнитель,
- сравняются приоритеты у каких-то заданий, если до того эти приоритеты были разные, то есть с изменением приоритетов необходимо переназначить работников на задания согласно шагу 1.

|Условие|Уравнение        |Результат|
|:------|:---------------:|:-------:|
|A=B    |31 - 4t = 28 - 3t|t = 3    |
|B=C    |28 - 3t = 22 - 2t|t = 6    |     
|C=D    |22 - 2t = 13 - t |t = 9    |
|D=E    |13 - t = 6       |t = 7    |

И берем самый "Ранний результат", когда приоритеты сменятся в первый раз => t = 3
Теперь снова построим таблицу заданий, но уже со смененными приоритетами и будем повторять шаги алгоритма (1),(2) до тех пор, пока все задачи не станут первого приоритета

<table>
  <tr>
    <th>Задания</th>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
  </tr>
  <tr>
    <td>Длительность</td>
    <td>19</td>
    <td>19</td>
    <td>16</td>
    <td>10</td>
    <td>6</td>
  </tr>
  <tr>
    <td>Приоритет</td>
    <td>1</td>
    <td>1</td>
    <td>2</td>
    <td>3</td>
    <td>4</td>
  </tr>
  <tr>
    <td>Исполнитель</td>
    <td colspan="2">P<sub>1</sub>P<sub>2</sub></td>
    <td>P<sub>3</sub></td>
    <td>P<sub>4</sub></td>
    <td></td>
  </tr>
</table>

После смены приоритетов:

$$
AB = 19
$$

$$
P_1P_2 = \frac{4 + 3}{2} = \frac{7}{2} = 3,5
$$

2 здесь - это количество заданий

|Условие|Уравнение        |Результат|
|:------|:---------------:|:-------:|
|AB=C   |19 - 3,5t = 16 - 2t|t = 2  |  
|C=D    |16 - 2t = 10 - t |t = 6    |
|D=E    |10 - t = 6       |t = 4  |

"Самый ранний" - t = 2

<table>
  <tr>
    <th>Задания</th>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
  </tr>
  <tr>
    <td>Длительность</td>
    <td>12</td>
    <td>12</td>
    <td>12</td>
    <td>8</td>
    <td>6</td>
  </tr>
  <tr>
    <td>Приоритет</td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
    <td>2</td>
    <td>3</td>
  </tr>
  <tr>
    <td>Исполнитель</td>
    <td colspan="3">P<sub>1</sub>P<sub>2</sub>P<sub>3</sub></td>
    <td>P<sub>4</sub></td>
    <td></td>
  </tr>
</table>

После смены приоритетов:

$$
ABC = 12
$$

$$
P_1P_2P_3 = \frac{4 + 3 + 2}{3} = 3
$$

|Условие|Уравнение        |Результат|
|:------|:---------------:|:-------:|
|ABC=D   |12 - 3t = 8 - t|t = 2  |  
|D=E    |8 - t = 6       |t = 2  |

"Самый ранний" и единственный - t = 2
<table>
  <tr>
    <th>Задания</th>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
    <th>E</th>
  </tr>
  <tr>
    <td>Длительность</td>
    <td>6</td>
    <td>6</td>
    <td>6</td>
    <td>6</td>
    <td>6</td>
  </tr>
  <tr>
    <td>Приоритет</td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
    <td>1</td>
  </tr>
  <tr>
    <td>Исполнитель</td>
    <td colspan="5">P<sub>1</sub>P<sub>2</sub>P<sub>3</sub>P<sub>4</sub></td>
  </tr>
</table>

После того как у всех задач приоритет стал одинаковым, все исполнители продолжнают работать над всеми задачами до конца.

# Ответ
## Диаграмма Ганта

```mermaid
gantt
    title Диаграмма Ганта - Стратегия разделения процессоров
    dateFormat DD HH:mm    
    axisFormat %H:%M
    Начало выполнения работ : milestone, m1, 01 00:00, 0h
    section Исполнитель 1
    A         :a1, 01 00:00, 3h
    A         :a2, after a1, 1h
    B         :a3, after a2, 1h
    A         :a4, after a3, 40m
    B         :a5, after a4, 40m
    C         :a6, after a5, 40m
    A         :a7, after a6, 36m
    B         :a8, after a7, 36m
    C         :a9, after a8, 36m
    D         :a10, after a9, 36m
    E         :a11, after a10, 36m
    section Исполнитель 2
    B         :b1, 01 00:00, 3h
    B         :b2, after b1, 1h
    A         :b3, after b2, 1h
    B         :b4, after b3, 40m
    C         :b5, after b4, 40m
    A         :b6, after b5, 40m
    B         :b7, after b6, 36m
    C         :b8, after b7, 36m
    D         :b9, after b8, 36m
    E         :b10, after b9, 36m
    A         :b11, after b10, 36m
    section Исполнитель 3
    C         :c1, 01 00:00, 3h
    C         :c2, after c1, 2h
    C         :c3, after c2, 40m
    A         :c4, after c3, 40m
    B         :c5, after c4, 40m
    C         :c6, after c5, 36m
    D         :c7, after c6, 36m
    E         :c8, after c7, 36m
    A         :c9, after c8, 36m
    B         :c10, after c9, 36m
    section Исполнитель 4
    D         :d1, 01 00:00, 3h
    D         :d2, after d1, 2h
    D         :d3, after d2, 2h
    D         :d4, after d3, 36m
    E         :d5, after d4, 36m
    A         :d6, after d5, 36m
    B         :d7, after d6, 36m
    C         :d8, after d7, 36m
    Окончание выполнения работ : milestone, m2, 01 10:00, 0h
```
## Оптимальное время выполнения всех заданий составляет 10, расписание представлено в виде диаграммы Ганта выше.
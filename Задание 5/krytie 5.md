# Задание №5 — Оптимальное расписание

## Команда `krytie`

## Вариант 7

### Исходные данные

| Задание | A  | B  | C  | D  | E  |
|:------:|:--:|:--:|:--:|:--:|:--:|
| Объём V_i | 33 | 31 | 26 | 11 |  9 |

**Исполнители**

| Исполнитель | 1 | 2 | 3 | 4 |
|:----------:|:-:|:-:|:-:|:-:|
| Производительность p_j | 4 | 3 | 2 | 1 |

## 1) Расчёт минимально возможного времени расписания

Суммарный объём работ:

$$
V_{\text{sum}} = 33 + 31 + 26 + 11 + 9 = 110
$$

Суммарная производительность:

$$
P_{\text{sum}} = 4 + 3 + 2 + 1 = 10
$$

Минимальная возможная длительность оптимального расписания:

$$
T_{\min} = V_{\text{sum}} / P_{\text{sum}} = 110 / 10 = 11
$$

**Вывод:** если удаётся построить расписание без простоев исполнителей на интервале [0;11], то оно будет **оптимальным**.

## 2) Стратегия разделения процессоров

- **Приоритет задания** в момент времени t — это **остаточный объём** работы по этому заданию.
- **Правило назначения:** задания с более высоким приоритетом получают более производительных исполнителей.
- **События, после которых пересматриваем назначения:**
  - приоритеты каких-то заданий становятся равны,
  - завершился очередной «кусок» работы, и исполнитель может быть переназначен.

> Примечание про равные приоритеты: если несколько заданий имеют одинаковый приоритет, можно выбрать любое распределение между ними — это не ухудшает оптимальность.

## 3) Построение расписания

Чтобы гарантировать оптимальность, строим расписание на время T_min = 11 **без простоев** и проверяем, что каждый объём V_i выполнен полностью.

### Шаг 0 — стартовые приоритеты и первичное назначение

В момент t=0:

- A=33, B=31, C=26, D=11, E=9
- Назначаем исполнителей по убыванию производительности на 4 задания с наибольшим приоритетом:
  - **исп.1** → A, p=4
  - **исп.2** → B, p=3
  - **исп.3** → C, p=2
  - **исп.4** → D, p=1

### Шаг 1 — первый момент изменения приоритетов, t=2

На интервале t ∈ [0;2] задания выполняются без прерываний. Посчитаем остатки:

- A: 33 - 4*2 = 25
- B: 31 - 3*2 = 25
- C: 26 - 2*2 = 22
- D: 11 - 1*2 = 9
- E: 9 — не выполнялось

В точке t=2 получаем два важных равенства приоритетов:

- A=B=25
- D=E=9

**Комментарий:** так как D и E сравнялись, дальше можно выбрать любое из них для выполнения самым медленным исполнителем. Чтобы всё успеть за T_min и не плодить микропереключения, выбираем выполнять E, а D доберём позже более быстрым исполнителем.

После t=2 назначаем:

- **исп.1** → A
- **исп.2** → B
- **исп.3** → C
- **исп.4** → E

и работаем так до момента t=6.5.

### Шаг 2 — момент t=6.5: перенос исп.3 с C на D

На интервале [2;6.5] длительность равна 4.5. Остаточные объёмы становятся:

- A: 25 - 4*4.5 = 7
- B: 25 - 3*4.5 = 11.5
- C: 22 - 2*4.5 = 13
- D: 9 — не выполнялось с t=2
- E: 9 - 1*4.5 = 4.5

**Комментарий:** с этого момента выгодно начать «догонять» D более быстрым исполнителем, поэтому **исп.3** переключаем с C на D.

Дальше на очень коротком интервале [6.5; 20/3] держим:

- **исп.1** → A
- **исп.2** → B
- **исп.3** → D
- **исп.4** → E

### Шаг 3 — момент t=20/3≈6.67: перенос исп.2 с B на C

После интервала длиной 1/6 остатки:

- A: 7 - 4/6 = 19/3
- B: 11.5 - 3/6 = 11
- C: 13 — не выполнялось на этом маленьком отрезке
- D: 9 - 2/6 = 26/3
- E: 4.5 - 1/6 = 13/3

**Комментарий:** задание B уже «достаточно уменьшили», теперь подключаем **исп.2** к заданию C, чтобы оно точно завершилось к T_min.

На интервале [20/3; 33/4] работаем так:

- **исп.1** → A
- **исп.2** → C
- **исп.3** → D
- **исп.4** → E

### Шаг 4 — момент t=33/4=8.25: завершили A, перенос исп.1 на B

Длительность интервала [20/3; 33/4] равна 19/12. Остатки в момент t=33/4:

- A: 19/3 - 76/12 = 0 — **задание A завершено**
- B: 11 — не выполнялось
- C: 13 - 57/12 = 33/4
- D: 26/3 - 38/12 = 11/2
- E: 13/3 - 19/12 = 11/4

**Комментарий:** как только A завершилось, самый быстрый исполнитель переключается на самое «тяжёлое» из оставшихся — B.

На последнем интервале [33/4; 11] длина 11/4=2.75 выполняем:

- **исп.1** → B
- **исп.2** → C
- **исп.3** → D
- **исп.4** → E

### Шаг 5 — момент t=11: завершение всех заданий

Проверка на финише:

- B: 11 - 44/4 = 0
- C: 33/4 - 33/4 = 0
- D: 11/2 - 22/4 = 0
- E: 11/4 - 11/4 = 0

Все задания завершены ровно к t=11, простоев нет.

## 4) Ответ

T_min = 11

## 5) Диаграмма Ганта

```mermaid
gantt
    title Диаграмма Ганта — Стратегия разделения процессоров, Вариант 7, krytie
    dateFormat DD HH:mm
    axisFormat %H:%M

    Начало выполнения работ : milestone, m1, 01 00:00, 0m

    section Исполнитель 1, p=4
    A :a1, 01 00:00, 495m
    B :a2, after a1, 165m

    section Исполнитель 2, p=3
    B :b1, 01 00:00, 400m
    C :b2, after b1, 260m

    section Исполнитель 3, p=2
    C :c1, 01 00:00, 390m
    D :c2, after c1, 270m

    section Исполнитель 4, p=1
    D :d1, 01 00:00, 120m
    E :d2, after d1, 540m

    Окончание выполнения работ : milestone, m2, 01 11:00, 0m
```
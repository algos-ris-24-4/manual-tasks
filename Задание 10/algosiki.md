# Задание №10. Задача о максимальном потоке. Вариант 3

## Исходные данные

Пропускная способность дуг сети:

|          Дуги          | sa | sc | sb | ab | ac | bc | bt | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|----|----|----|
| Пропускная способность | 8  | 7  | 5  | 3  | 6  | 5  | 5  | 10 |

### Шаг 1:
Строим ориентированный граф с источником S и стоком t. На дуги пишем их пропускную способность.

картинка 1

Строим остаточную сеть. Так как нам не дан поток, все дуги оставляем пустыми. Из-за этого в остаточную сеть вносим обратные дуги с весом пропускной способности.

картинка 2

### Шаг 2 (начало цикла):
Ищем увеличивающий путь в остаточной сети: был выбран путь t -> c -> S. Минимальный вес дуг на этом пути равен 7.

картинка 3

Вычитаем из веса дуг минимальное значение (7), к обратным - добавляем его. Дуги, которые стали нулевыми, удаляем.

картинка 4

Сейчас граф выглядит так: на нём изображены локальные потоки исходной сети и пропускные способности (первая цифра - локальный поток, вторая - пропускная способность).

картинка 5

F(поток) = 7 + 0 = 7

### Шаг 3 (2 итерация цикла):

По новой ищем увеличивающий путь в остаточной сети: был выбран путь t -> b -> S. Минимальный вес дуг на этом пути равен 5.

картинка 6

Вычитаем из веса дуг минимальное значение (5), к обратным - добавляем его. Дуги, которые стали нулевыми, удаляем.

картинка 7

Сейчас граф выглядит так: на нём изображены локальные потоки исходной сети и пропускные способности (первая цифра - локальный поток, вторая - пропускная способность).

картинка 8

F(поток) = 7 + 5 = 12

### Шаг 4 (3 итерация цикла):

По новой ищем увеличивающий путь в остаточной сети: был выбран путь t -> c -> a -> S. Минимальный вес дуг на этом пути равен 3.

картинка 9

Вычитаем из веса дуг минимальное значение (3), к обратным - добавляем его. Дуги, которые стали нулевыми, удаляем.

картинка 10

Сейчас граф выглядит так: на нём изображены локальные потоки исходной сети и пропускные способности (первая цифра - локальный поток, вторая - пропускная способность).

картинка 11

F(поток) = 10 + 5 = 15

### Шаг 5 (4 итерация цикла):
Увеличивающего пути нет -> текущий поток является максимальным -> задача решена -> алгоритм завершает работу.

картинка 12

F(максимальный) = 15

### Шаг 6 (локальный и глобальный законы)

Проверим локальный закон сохранения потока:

1) в b входит 5 + 0 (Sb и ab), выходит 5 (bt) = 5
2) в a входит 3 (Sa), выходит 0 + 3 (ab, ac) = 3
3) в c входит 7 + 3 + 0 (Sc, ac, bc), выходит 10 (ct) = 10

Проверим глобальный закон сохранения потока:

из S выходит 5 + 3 + 7 (Sb, Sa, Sc), в t входит 5 + 10 (bt, ct) = 15
### Шаг 7 (разрезы)

Проверяем значение максимального потока перебором всех разрезов сети.
Чтобы вычислить пропускную способность разреза, нужно сложить пропускные способности всех дуг, выходящих из подмножества Vs и идущих в Vt.
Всего вариантов разреза = 2^(n-2)

| Vs  | Vt   | Пропускная способность |
|-----|------|------------------------|
| S    | t, a, b, c     |     5 + 8 + 7 = 20                   |
| S, a    |  t, b, c    |      5 + 6 + 3 + 7 = 21              | 
| S, b   |  t, a, c    |         8 + 7 + 5 + 5 = 25            | 
| S, c    |   t, a, b   |         5 + 8 + 10 = 23              | 
| S, a, b   |  t, c    |            7 + 6 + 5 + 5 = 23         | 
| S, a, c    |  t, b    |           5 + 3 + 10 = 18            | 
| S, b, c    |  t, a    |           8 + 5 + 10 = 23            | 
| S, a, b, c    |   t   |           5 + 10 = 15                | 

Согласно теореме Форда-Фолкерсона:

Минимальная пропускная способность разреза равна 15 ( Vs = {s, a, b, c}, Vt = {t} ), что совпадает с найденной величиной максимального потока в сети.

### Ответ:
Максимальный поток в сети равен 15, он реализуется следующим локальными потоками:

Картинка 11
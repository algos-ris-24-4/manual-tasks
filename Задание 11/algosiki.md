# Задание №11. Задача о максимальном потоке минимальной стоимости
# Вариант 1

Пропускная способность дуг сети и стоимость транспортировки указана в таблице.

| Дуги                      | sc | sd | sa | ab | da | cb | db | bt |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность    | 3  | 4  | 5  | 5  | 4  | 3  | 4  | 10 |
| Стоимость транспортировки | 4  | 3  | 1  | 2  | 2  | 1  | 3  | 2  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

<img width="817" height="478" alt="image" src="https://github.com/user-attachments/assets/589c7292-ad8a-4b4e-be49-1ca941514c6e" />

Укажем начальный поток величиной 4 **s -> d -> b -> t**. 

<img width="837" height="489" alt="image" src="https://github.com/user-attachments/assets/a2ba25cc-683d-4bc0-afd1-4a3f101a5e5c" />

Построим соответствующую остаточную сеть.

<img width="792" height="484" alt="image" src="https://github.com/user-attachments/assets/30498af3-f726-45f2-9478-327c77939b8f" />

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> b -> c -> s. Минимальный вес дуг на этом пути равен 3.

<img width="807" height="492" alt="image" src="https://github.com/user-attachments/assets/855c6a10-1fff-4dc1-963e-faec52a8148c" />

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

<img width="783" height="475" alt="image" src="https://github.com/user-attachments/assets/26eb629a-3914-44e9-ab0d-865db232cea4" />

### 3. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> b -> a -> s. Минимальный вес дуг на этом пути равен 3.

<img width="828" height="467" alt="image" src="https://github.com/user-attachments/assets/4a241609-aa78-41ba-938e-0d0c2d55a699" />

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

<img width="852" height="502" alt="image" src="https://github.com/user-attachments/assets/fda4f3ed-9df1-4b57-a22b-90975c3448bb" />

### 4. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 10 является максимальным для данной сети.

<img width="824" height="454" alt="image" src="https://github.com/user-attachments/assets/643412d0-8f05-4142-b0ae-1b772d4b58d7" />

### 5. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sc | sd | sa | ab | da | cb | db | bt | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 5  | 4  | 3  | 4  | 10 |        |
| Локальный поток f(e)                          | 3  | 4  | 3  | 3  | 0  | 3  | 4  | 10 |        |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 2  | 2  | 1  | 3  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 12 | 3  | 6  | 0  | 3  | 12 | 20 |  **68**|

Стоимость полученного потока составляет 68. 

### 6. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

<img width="830" height="470" alt="image" src="https://github.com/user-attachments/assets/60426305-b59a-4c7f-a03c-a8d1d272c890" />

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> b -> a -> s (- 4 - 1 + 2 + 1 = -2). 

<img width="642" height="335" alt="image" src="https://github.com/user-attachments/assets/8c6f492b-a763-4afb-a009-5e8c8756fa8f" />

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

<img width="621" height="356" alt="image" src="https://github.com/user-attachments/assets/457814a6-240f-4843-8b66-a38650c08c3f" />

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребер a -> d и s -> a.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

<img width="1109" height="311" alt="image" src="https://github.com/user-attachments/assets/abce73ca-d26c-4b1c-a89d-125776866625" />

### 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> d -> b -> c -> s (- 3 - 3 + 1 + 4 = -1). 

<img width="1132" height="342" alt="image" src="https://github.com/user-attachments/assets/489ac412-0816-4e54-b2c4-d5fd57f38e50" />

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребер s -> c и c -> b.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

<img width="1110" height="338" alt="image" src="https://github.com/user-attachments/assets/81a1cfc8-3558-4c83-ab8a-bc9fba61f22f" />

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

### 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 8. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sc | sd | sa | ab | da | cb | db | bt | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 3  | 4  | 5  | 5  | 4  | 3  | 4  | 10 |        |
| Локальный поток f(e)                          | 3  | 2  | 5  | 5  | 0  | 3  | 2  | 10 |        |
| Стоимость транспортировки единицы потока c(e) | 4  | 3  | 1  | 2  | 2  | 1  | 3  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 6  | 5  | 10 | 0  | 3  | 6  | 20 | **62** |

Стоимость полученного потока составляет 62. 

### Ответ:
Максимальный поток в сети равен 10, минимальная стоимость потока 62, она реализуется следующим локальными потоками:

<img width="541" height="352" alt="image" src="https://github.com/user-attachments/assets/e033aff0-9aee-4986-ac88-4d32776ccad7" />

# Вариант 4

## Задача о максимальном потоке минимальной стоимости

**Условие варианта:**

Пропускная способность дуг сети \( p(e) \) и стоимость транспортировки единицы потока \( c(e) \):

| Дуги    | sa | at | ac | ab | ad | sc | cb | bd | dt |
|---------|----|----|----|----|----|----|----|----|----|
| Пропускная способность | 5  | 5  | 2  | 4  | 11 | 11 | 5  | 9  | 13 |
| Стоимость транспортировки | 2  | 8  | 3  | 4  | 6  | 3  | 2  | 2  | 1  |


### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

![4](https://github.com/user-attachments/assets/ec77eed5-3383-4a48-8a36-961729ed2f40)



Укажем начальный поток величиной 5 **s -> a -> t**.

![2](https://github.com/user-attachments/assets/df57a0b0-9414-46ed-ad4c-5e8daf5b0222)


Построим соответствующую остаточную сеть.

![6](https://github.com/user-attachments/assets/b87104fb-3760-4996-9591-38b85324d556)



### 2. Проведем поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь **s -> c -> b -> d -> t**. Минимальный вес дуг на этом пути равен 5.

![photo_2026-02-19_21-42-30](https://github.com/user-attachments/assets/b5221fdb-fcb3-40c1-81b6-a7f778930c8a)

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.


![photo_2026-02-19_21-28-19](https://github.com/user-attachments/assets/d6b95234-e260-46fc-942e-6e1e849a9c28)


### 3. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 10 является максимальным для данной сети.

![5](https://github.com/user-attachments/assets/044dd498-de58-4749-86db-514aa07ba9e9)


### 4. Расчет стоимости полученного максимального потока после двух итераций:

| Дуги    | sa | at | ac | ab | ad | sc | cb | bd | dt | **Итого** |
|---------|----|----|----|----|----|----|----|----|----|-----------|
| Пропускная способность p(e) | 5  | 5  | 2  | 4  | 11 | 11 | 5  | 9  | 13 |           |
| Локальный поток  f(e)       | 5  | 5  | 0  | 0  | 0  | 5  | 5  | 5  | 5  |           |
| Стоимость транспортировки c(e) | 2  | 8  | 3  | 4  | 6  | 3  | 2  | 2  | 1  |           |
| Суммарная стоимость f(e) * c(e)| 10 | 40 | 0  | 0  | 0  | 15 | 10 | 10 | 5  |   **90**   |

**Стоимость полученного потока составляет 90.**



### 5. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

![стоимости 1](https://github.com/user-attachments/assets/8a2a385f-af06-46b3-8d9a-9d79bc62d10e)

В остаточной сети найден ориентированный цикл отрицательной стоимости a -> t -> d -> a (-8 + 1 + 6 = -1).

![цикл 1](https://github.com/user-attachments/assets/3ebb9ce8-f3bc-4225-93c7-9e4b61f7f3f9)

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

![проекция 1](https://github.com/user-attachments/assets/c8c9de2e-9b8d-4677-b1bf-164976f2bb8d)

Минимальный вес ребра в цикле 5 - это неиспользованный резерв ребра a -> t.

Удалим найденный цикл - уменьшим на 5 вес всех ребер, входящих в цикл.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

![корректировка 1](https://github.com/user-attachments/assets/5eb9b439-5087-42ff-8d97-53a1326808b4)  ![цикл 2 приквел](https://github.com/user-attachments/assets/29fe9f15-c363-4559-b95b-3857146beae7)

### 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 7. Рассчитаем стоимость полученного максимального потока.

| Дуги    | sa | at | ac | ab | ad | sc | cb | bd | dt | **Итого** |
|---------|----|----|----|----|----|----|----|----|----|-----------|
| Пропускная способность p(e) | 5  | 5  | 2  | 4  | 11 | 11 | 5  | 9  | 13 |           |
| Локальный поток  f(e)       | 5  | 5  | 0  | 0  | 0  | 5  | 5  | 5  | 5  |           |
| Стоимость транспортировки c(e) | 2  | 8  | 3  | 4  | 6  | 3  | 2  | 2  | 1  |           |
| Суммарная стоимость f(e) * c(e)| 10 | 40 | 0  | 0  | 0  | 15 | 10 | 10 | 5  |   **90**   |

**Стоимость полученного потока составляет 90.**



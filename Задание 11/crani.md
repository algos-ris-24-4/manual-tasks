## Решение задания 11

### Вариант 2:

#### Пропускная способность дуг сети p(e) и стоимость транспортировки единицы потока c(e):

| Дуги                      | sa  | sc  | ab  | ad  | ac  | cd  | bd  | dt  |
| :------------------------ | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| Пропускная способность    |  9  |  9  |  5  |  5  |  5  | 11  |  5  | 12  |
| Стоимость транспортировки |  3  |  3  |  3  |  6  |  3  |  8  |  3  |  3  |

### 1. Построим сеть с источником s, стоком t и указанными пропускными способностями дуг для поиска максимального потока

Укажем начальный поток величиной 9 s -> c -> -> d -> t

Построим соответствующую остаточную сеть

### 2. Проведём поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> d -> a -> s. Минимальный вес дуг на этом пути равен 3.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети

### 3. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 12 является максимальным для данной сети.

### 4. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa  | sc  | ab  | ad  | ac  | cd  | bd  | dt  |  Итого  |
| :-------------------------------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-----: |
| Пропускная способность p(e)                   |  9  |  9  |  5  |  5  |  5  | 11  |  5  | 12  |         |
| Локальный поток f(e)                          |  3  |  9  |  0  |  3  |  0  |  9  |  0  | 12  |         |
| Стоимость транспортировки единицы потока c(e) |  3  |  3  |  3  |  6  |  3  |  8  |  3  |  3  |         |
| Суммарная стоимость f(e)\*c(e)                |  9  | 27  |  0  | 18  |  0  | 72  |  0  | 36  | **162** |

Стоимость полученного потока составляет 162.

Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> d -> a -> s (-3-8+6+3 = -2)

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра a -> d.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

### Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> d -> b -> a -> s (-3-8+3+3+3 = -2)

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

Минимальный вес ребра в цикле 4 - это неиспользованный резерв ребра s -> a.

Удалим найденный цикл - уменьшим на 4 вес всех ребер, входящих в цикл.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

### Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa  | sc  | ab  | ad  | ac  | cd  | bd  | dt  |  Итого  |
| :-------------------------------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-----: |
| Пропускная способность p(e)                   |  9  |  9  |  5  |  5  |  5  | 11  |  5  | 12  |         |
| Локальный поток f(e)                          |  9  |  3  |  4  |  5  |  0  |  3  |  4  | 12  |         |
| Стоимость транспортировки единицы потока c(e) |  3  |  3  |  3  |  6  |  3  |  8  |  3  |  3  |         |
| Суммарная стоимость f(e)\*c(e)                | 27  |  9  | 12  | 30  |  0  | 24  | 12  | 36  | **150** |

Стоимость полученного потока составляет 150

### Ответ:

Максимальный поток в сети равен 12, минимальная стоимость потока 150, она реализуется следующим локальными потоками:

## Решение задания 11

### Вариант 2:

#### Пропускная способность дуг сети p(e) и стоимость транспортировки единицы потока c(e):

| Дуги                      | sa  | sc  | ab  | ad  | ac  | cd  | bd  | dt  |
| :------------------------ | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| Пропускная способность    |  9  |  9  |  5  |  5  |  5  | 11  |  5  | 12  |
| Стоимость транспортировки |  3  |  3  |  3  |  6  |  3  |  8  |  3  |  3  |

### 1. Построим сеть с источником s, стоком t и указанными пропускными способностями дуг для поиска максимального потока

<img width="735" height="469" alt="image" src="https://github.com/user-attachments/assets/7ac1063e-f32b-4a21-beab-6419ada7012b" />

Укажем начальный поток величиной 9 s -> c -> -> d -> t

<img width="725" height="441" alt="image" src="https://github.com/user-attachments/assets/1d00dfcf-2cef-4308-9010-b5a02b5eb40e" />

Построим соответствующую остаточную сеть

<img width="705" height="430" alt="image" src="https://github.com/user-attachments/assets/ce9f73e7-eda1-4c9c-ab70-22c28a541569" />

### 2. Проведём поиск увеличивающего пути в остаточной сети

В остаточной сети найден увеличивающий путь t -> d -> a -> s. Минимальный вес дуг на этом пути равен 3.

<img width="574" height="362" alt="image" src="https://github.com/user-attachments/assets/01187333-a371-4dd7-9d93-957e4ff3acac" />

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети

<img width="603" height="359" alt="image" src="https://github.com/user-attachments/assets/66a4d292-3c1e-4faa-91f4-42d6b1545022" />

### 3. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 12 является максимальным для данной сети.

<img width="601" height="353" alt="image" src="https://github.com/user-attachments/assets/a5ebb99f-eecc-4c39-9b97-0836a7cb4287" />

### 4. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa  | sc  | ab  | ad  | ac  | cd  | bd  | dt  |  Итого  |
| :-------------------------------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-----: |
| Пропускная способность p(e)                   |  9  |  9  |  5  |  5  |  5  | 11  |  5  | 12  |         |
| Локальный поток f(e)                          |  3  |  9  |  0  |  3  |  0  |  9  |  0  | 12  |         |
| Стоимость транспортировки единицы потока c(e) |  3  |  3  |  3  |  6  |  3  |  8  |  3  |  3  |         |
| Суммарная стоимость f(e)\*c(e)                |  9  | 27  |  0  | 18  |  0  | 72  |  0  | 36  | **162** |

Стоимость полученного потока составляет 162.

Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

<img width="566" height="382" alt="image" src="https://github.com/user-attachments/assets/aa04655c-2080-45a2-9c4e-2eafe904bef1" />

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> d -> a -> s (-3-8+6+3 = -2)

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

<img width="591" height="367" alt="image" src="https://github.com/user-attachments/assets/1da12f8d-9045-4a31-a423-d7c8d1092e8b" />

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра a -> d.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

<img width="1164" height="411" alt="image" src="https://github.com/user-attachments/assets/cd833950-8194-43a7-8e3d-7732c402664f" />

### Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети найден ориентированный цикл отрицательной стоимости s -> c -> d -> b -> a -> s (-3-8+3+3+3 = -2)

<img width="1168" height="404" alt="image" src="https://github.com/user-attachments/assets/9bd61778-b249-4c57-af6e-d8f67e13a0eb" />

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

Минимальный вес ребра в цикле 4 - это неиспользованный резерв ребра s -> a.

Удалим найденный цикл - уменьшим на 4 вес всех ребер, входящих в цикл.

<img width="1249" height="381" alt="image" src="https://github.com/user-attachments/assets/955112a7-e665-4bfe-9dd2-735227285b21" />

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

### Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa  | sc  | ab  | ad  | ac  | cd  | bd  | dt  |  Итого  |
| :-------------------------------------------- | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-----: |
| Пропускная способность p(e)                   |  9  |  9  |  5  |  5  |  5  | 11  |  5  | 12  |         |
| Локальный поток f(e)                          |  9  |  3  |  4  |  5  |  0  |  3  |  4  | 12  |         |
| Стоимость транспортировки единицы потока c(e) |  3  |  3  |  3  |  6  |  3  |  8  |  3  |  3  |         |
| Суммарная стоимость f(e)\*c(e)                | 27  |  9  | 12  | 30  |  0  | 24  | 12  | 36  | **150** |

Стоимость полученного потока составляет 150

### Ответ:

Максимальный поток в сети равен 12, минимальная стоимость потока 150, она реализуется следующим локальными потоками:

<img width="594" height="353" alt="image" src="https://github.com/user-attachments/assets/ce473c0a-f758-4c93-9c1f-ee7919ad836a" />
